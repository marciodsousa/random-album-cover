language: node_js
node_js:
- '7'
sudo: enabled
addons:
  ssh_known_hosts: 146.185.133.5
env:
  global:
  - REMOTE_APP_DIR=/usr/share/html/free-pooch/
  - REMOTE_USER=centos
  - REMOTE_HOST=146.185.133.5 # your droplet IP goes here
  - PORT=8080
before_install:
- openssl aes-256-cbc -K $encrypted_afbd8d8994e1_key -iv $encrypted_afbd8d8994e1_iv
  -in do_deploy_key.enc -out do_deploy_key -d
- bash deploy/install.sh
script:
- bash deploy/build.sh
- bash deploy/test.sh
after_success:
- bash deploy/deploy.sh
cache:
  directories:
  - client/node_modules
  - server/node_modules
  yarn: true
